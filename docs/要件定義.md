
# Google Analytics Web分析アプリ 要件定義

## 🎯 プロジェクト概要

**目的**:
Google Analytics（GA4）のデータを手軽に分析・可視化できる Web アプリを構築する。

**特徴**:
- ブラウザ上で動作し、（可能であれば）サーバー不要な構成を目指す。
- Googleログインを通じて自動的にGA4データを取得。
- SQLクエリで自由に分析し、表やグラフで可視化。

---

## 🧱 機能要件

### 1. Googleログイン & データ取得
- GoogleアカウントによるOAuth 2.0認証を実装。
- ユーザーがGoogle Analyticsの読み取りスコープを許可。
- 認証後、GA4プロパティ一覧を取得し、選択可能にする。
- 選択されたプロパティから、Google Analytics Data APIを用いてデータ取得。

### 2. データ分析
- DuckDB-WASM を使用して、取得したデータに対して SQL クエリを実行。
- 事前定義されたクエリテンプレート（例: ユーザー数の推移、ページビューランキング）を提供。
- ユーザーが自由に SQL クエリを入力してカスタム分析が可能。

### 3. 可視化
- 分析結果を表形式で表示。
- 折れ線グラフ、棒グラフなど、チャートによる可視化を提供。

### 4. データ保存と再利用
- ブラウザのOPFSやIndexedDBに保存し、アップロード不要で再利用可能に。
- 作成したクエリも保存・再利用可能。

### 5. クエリ共有・インポート機能（オプション）
- 作成したSQLクエリを他のユーザーと共有可能なURLとして出力。
- 他者が作成したクエリをインポートして活用できる。

### 6. 時系列比較やセグメント機能
- 特定の期間を比較して分析できる（例：今月 vs 先月）。
- デバイス別・地域別など、セグメントで絞り込んだ分析が可能。

### 7. データのキャッシュとスケジューリング（ブラウザ側で可能な範囲で）
- 一度取得したデータは指定期間キャッシュし、毎回のAPI呼び出しを抑制。
- 分析を定期実行して、毎朝のアクセス数推移などを自動表示（擬似スケジュール機能）。

### 8. アクセス権限とプライバシー
- アプリがどの情報にアクセスするか、明示的に表示。
- ユーザーが「保存しないモード」を選択できる（シークレットモード的機能）。

### 9. 簡易なノーコードモード（クエリを書かずに使いたい人向け）
- プルダウンやチェックボックスで条件指定し、クエリを自動生成。
- 初心者でも簡単にグラフを作成できるUI。

---

## 📚 参考リソース
- [Google Analytics Data API](https://developers.google.com/analytics/devguides/reporting/data/v1)
- [DuckDB-WASM 公式](https://duckdb.org/2021/10/29/duckdb-wasm.html)
- [Parquet読み込み](https://duckdb.org/docs/data/parquet/overview.html)
- [Monaco Editor](https://microsoft.github.io/monaco-editor/)
- [Chart.js](https://www.chartjs.org/)

